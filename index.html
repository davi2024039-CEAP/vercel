<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RPG Lab Ci√™ncia Descoberta</title>
<style>
  :root {
    --bg: #0a0e17;
    --prat: #112244;
    --glow: 0 0 20px #00ffff;
    --bright: #0ff;
  }
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  body {
    background: var(--bg);
    color: #e0f7fa;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }
  .estrelas {
    position: fixed;
    inset: 0;
    z-index: -1;
    background: radial-gradient(circle at 20% 80%, #1a3a5a 1px, transparent 1px),
      radial-gradient(circle at 80% 20%, #1a3a5a 1px, transparent 1px);
    background-size: 60px 60px;
    animation: twinkle 15s linear infinite;
  }
  @keyframes twinkle {
    0%, 100% {opacity: 0.8;}
    50% {opacity: 1;}
  }
  header {
    text-align: center;
    padding: 2rem 1rem;
    background: linear-gradient(180deg, #0a0e17, #112255);
    box-shadow: 0 10px 30px rgba(0, 255, 255, 0.3);
    position: relative;
    user-select: none;
  }
  header h1 {
    font-size: 3rem;
    color: var(--bright);
    text-shadow: var(--glow);
    font-weight: 900;
    letter-spacing: 3px;
  }
  header p {
    font-weight: 600;
    color: #a0f0ff;
    margin-top: 0.5rem;
    font-size: 1.2rem;
  }
  #introScreen {
    position: fixed;
    inset: 0;
    background: #001f33cc;
    color: var(--bright);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 2rem;
    z-index: 1000;
    text-align: center;
    font-size: 1.2rem;
  }
  #introScreen h2 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    text-shadow: var(--glow);
  }
  #startBtn {
    margin-top: 1.5rem;
    background: var(--bright);
    color: #002222;
    padding: 1.2rem 4rem;
    font-size: 1.3rem;
    font-weight: 700;
    border: none;
    border-radius: 30px;
    cursor: pointer;
    transition: background 0.3s ease;
    box-shadow: var(--glow);
  }
  #startBtn:hover {
    background: #00cccc;
  }
  .lab {
    max-width: 1000px;
    margin: 2rem auto 4rem;
    padding: 0 1rem;
  }
  .level-title {
    font-size: 1.8rem;
    color: var(--bright);
    text-align: center;
    text-shadow: var(--glow);
    margin-bottom: 1rem;
  }
  .prateleira {
    display: flex;
    justify-content: center;
    gap: 2rem;
    flex-wrap: wrap;
    margin-bottom: 3rem;
  }
  .frasco {
    width: 110px;
    height: 190px;
    cursor: pointer;
    border-radius: 16px;
    background: var(--prat);
    box-shadow: 0 0 15px #00ffff33;
    display: flex;
    flex-direction: column;
    align-items: center;
    user-select: none;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    position: relative;
    overflow: hidden;
  }
  .frasco:hover:not(.used) {
    transform: scale(1.2);
    box-shadow: 0 0 30px var(--bright);
    z-index: 10;
  }
  .frasco.used {
    filter: brightness(0.65);
    cursor: default;
  }
  .frasco.used::after {
    content: "‚úî";
    position: absolute;
    top: 8px;
    right: 8px;
    color: var(--bright);
    font-size: 1.8rem;
    font-weight: 900;
    text-shadow: 0 0 8px var(--bright);
  }
  .emoji {
    font-size: 3rem;
    margin: 10px 0 6px;
  }
  .rotulo {
    color: var(--bright);
    font-weight: 700;
    font-size: 1rem;
    text-align: center;
    padding: 0 10px;
  }
  /* Modal */
  #modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.9);
    backdrop-filter: blur(12px);
    display: none;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    z-index: 1100;
  }
  #modal.show {
    display: flex;
  }
  .card {
    background: var(--prat);
    padding: 2rem;
    border-radius: 20px;
    max-width: 480px;
    width: 100%;
    color: var(--bright);
    position: relative;
    box-shadow: var(--glow);
    max-height: 90vh;
    overflow-y: auto;
  }
  .card h3 {
    text-align: center;
    margin-bottom: 1rem;
    font-size: 2rem;
  }
  .ingredientes, .passos {
    padding-left: 1.2rem;
    margin-bottom: 1rem;
  }
  .ingredientes li {
    background: #00293499;
    margin-bottom: 6px;
    padding: 8px 10px;
    border-left: 4px solid var(--bright);
    border-radius: 6px;
  }
  .passos li {
    margin-bottom: 10px;
    counter-increment: step;
    position: relative;
  }
  .passos {
    counter-reset: step;
  }
  .passos li::before {
    content: counter(step);
    position: absolute;
    left: -1.5rem;
    background: var(--bright);
    color: #000;
    font-weight: 700;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    text-align: center;
    line-height: 28px;
  }
  .fechar {
    position: absolute;
    top: 12px;
    right: 12px;
    background: var(--bright);
    border: none;
    border-radius: 50%;
    color: #000;
    font-size: 1.5rem;
    font-weight: 900;
    width: 36px;
    height: 36px;
    cursor: pointer;
  }
  .video {
    width: 100%;
    height: 210px;
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 1rem;
  }

  /* Scoreboard */
  #scoreBoard {
    position: fixed;
    top: 15px;
    right: 20px;
    background: rgba(0, 255, 255, 0.2);
    padding: 12px 22px;
    border-radius: 24px;
    font-weight: 700;
    color: var(--bright);
    text-shadow: var(--glow);
    user-select: none;
    font-size: 1.4rem;
    z-index: 1001;
  }
  /* Feedback message */
  #feedback {
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: #00ffffcc;
    padding: 12px 25px;
    border-radius: 30px;
    font-weight: 700;
    color: #002222;
    box-shadow: var(--glow);
    display: none;
    z-index: 1001;
  }
  #feedback.show {
    display: block;
  }
  /* Quiz Modal */
  #quizModal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.9);
    backdrop-filter: blur(12px);
    display: none;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    z-index: 1100;
  }
  #quizModal.show {
    display: flex;
  }
</style>
</head>
<body>
<div class="estrelas"></div>
<header>
  <h1>üß™ RPG Lab Ci√™ncia Descoberta</h1>
  <p>Descubra segredos cient√≠ficos para completar experimentos e subir de n√≠vel!</p>
</header>

<div id="introScreen">
  <h2>Bem-vindo, Aventureiro da Ci√™ncia!</h2>
  <p>Neste RPG, voc√™ √© um aprendiz que deve descobrir conceitos cient√≠ficos para desbloquear experimentos, ganhar XP e subir de n√≠vel.<br>
     Clique em um frasco para enfrentar um desafio cient√≠fico.<br>
     Responda corretamente para completar o experimento e avan√ßar.<br>
     Complete todos os n√≠veis para se tornar um Mestre Cientista!</p>
  <button id="startBtn">Iniciar Aventura</button>
</div>

<div id="scoreBoard">XP: 0 | N√≠vel: 1</div>
<div id="feedback"></div>

<main class="lab" style="display:none;">

  <!-- N√çVEL 1 -->
  <section>
    <h2 class="level-title">üåã Vulc√µes & Explos√µes</h2>
    <div class="prateleira" id="nivel1">
      <div class="frasco" data-nome="Vulc√£o Cl√°ssico" data-id="vulcao" data-cor="#ff4500" title="Vulc√£o Cl√°ssico">
        <div class="emoji">üåã</div>
        <div class="rotulo">Vulc√£o</div>
      </div>
      <div class="frasco" data-nome="Elefante de Pasta" data-id="elefante" data-cor="#ff69b4" title="Elefante de Pasta">
        <div class="emoji">ü¶£</div>
        <div class="rotulo">Elefante</div>
      </div>
      <div class="frasco" data-nome="Foguete √Åcido" data-id="foguete" data-cor="#00ff00" title="Foguete √Åcido">
        <div class="emoji">üöÄ</div>
        <div class="rotulo">Foguete</div>
      </div>
    </div>
  </section>

  <!-- N√çVEL 2 -->
  <section>
    <h2 class="level-title">üåà Cores & Luz</h2>
    <div class="prateleira" id="nivel2">
      <div class="frasco" data-nome="Lava Lamp" data-id="lava" data-cor="#ff00ff" title="Lava Lamp">
        <div class="emoji">üí°</div>
        <div class="rotulo">Lava Lamp</div>
      </div>
      <div class="frasco" data-nome="Repolho Indicador" data-id="repolho" data-cor="#9400d3" title="Repolho Indicador">
        <div class="emoji">ü•¨</div>
        <div class="rotulo">pH M√°gico</div>
      </div>
      <div class="frasco" data-nome="Tinta Invis√≠vel" data-id="invisivel" data-cor="#ffff00" title="Tinta Invis√≠vel">
        <div class="emoji">üïµÔ∏è</div>
        <div class="rotulo">Invis√≠vel</div>
      </div>
    </div>
  </section>

  <!-- N√çVEL 3 -->
  <section>
    <h2 class="level-title">‚ùÑÔ∏è Cristais & Gelo</h2>
    <div class="prateleira" id="nivel3">
      <div class="frasco" data-nome="Cristal em 2h" data-id="cristal" data-cor="#00ffff" title="Cristal em 2h">
        <div class="emoji">üíé</div>
        <div class="rotulo">Cristal R√°pido</div>
      </div>
      <div class="frasco" data-nome="Gelo Quente" data-id="gelo" data-cor="#87ceeb" title="Gelo Quente">
        <div class="emoji">üî•‚ùÑÔ∏è</div>
        <div class="rotulo">Gelo Quente</div>
      </div>
    </div>
  </section>

</main>

<!-- Modal receita -->
<div id="modal">
  <div class="card">
    <button class="fechar" title="Fechar">√ó</button>
    <h3 id="titulo"></h3>
    <div class="video"></div>
    <p><b>Ingredientes:</b></p>
    <ul class="ingredientes" id="ing"></ul>
    <p><b>Passo a passo:</b></p>
    <ol class="passos" id="passos"></ol>
    <p><b>Seguran√ßa:</b> √ìculos + pia + adulto por perto!</p>
  </div>
</div>

<!-- Quiz Modal -->
<div id="quizModal">
  <div class="card">
    <button class="fechar" id="quizClose" title="Fechar">√ó</button>
    <h3 id="quizTitle"></h3>
    <p id="quizQuestion"></p>
    <div id="options"></div>
  </div>
</div>

<script>
  const recipes = {
    vulcao: {
      nome: "Vulc√£o Cl√°ssico",
      ing: ["1/2 x√≠cara de bicarbonato", "1/2 x√≠cara de vinagre", "Corante vermelho", "Detergente"],
      passos: ["Coloque bicarbonato no copo","Adicione 3 gotas de detergente","Pingue corante","Despeje vinagre e FUJA!"],
      video: "https://www.youtube.com/embed/0yOznKmgpxQ",
      ingredientesIds: ["vulcao"]
    },
    elefante: {
      nome: "Elefante de Pasta",
      ing: ["1 garrafa PET pequena","100ml √°gua oxigenada 10vol","5 gotas detergente","Corante","1 colher fermento"],
      passos: ["Misture √°gua oxigenada + detergente + corante na garrafa","Adicione fermento","Feche os olhos e veja a pasta explodir!"],
      video: "https://www.youtube.com/embed/PygjKCTcwqY",
      ingredientesIds: ["elefante"]
    },
    foguete: {
      nome: "Foguete √Åcido",
      ing: ["Filme de PVC","3 colheres bicarbonato","1/2 x√≠cara vinagre"],
      passos: ["Enrole bicarbonato no filme","Coloque no gargalo da garrafa com vinagre","Tampe r√°pido e solte no ch√£o!"],
      video: "https://www.youtube.com/embed/5MdUyZwaFfQ",
      ingredientesIds: ["foguete"]
    },
    lava: {
      nome: "Lava Lamp",
      ing: ["√ìleo vegetal","√Ågua","Corante aliment√≠cio","Comprimido efervescente"],
      passos: ["Encha 3/4 com √≥leo","Complete com √°gua colorida","Jogue 1/2 comprimido e veja as bolhas!"],
      video: "https://www.youtube.com/embed/TU4aS5KgVxU",
      ingredientesIds: ["lava"]
    },
    repolho: {
      nome: "Repolho Indicador",
      ing: ["1/4 repolho roxo","√Ågua quente","Vinagre, bicarbonato, suco de lim√£o"],
      passos: ["Ferva repolho 10min","Filtre o suco roxo","Adicione √°cidos/bases e veja a cor mudar!"],
      video: "https://www.youtube.com/embed/cMUzErlnWqs",
      ingredientesIds: ["repolho"]
    },
    invisivel: {
      nome: "Tinta Invis√≠vel",
      ing: ["Suco de lim√£o","Cotonete","L√¢mpada quente"],
      passos: ["Escreva com lim√£o no papel","Seque","Aque√ßa com l√¢mpada ‚Üí mensagem aparece!"],
      video: "https://www.youtube.com/embed/OsoWhR8dny4",
      ingredientesIds: ["invisivel"]
    },
    cristal: {
      nome: "Cristal em 2h",
      ing: ["200ml √°gua quente","6 colheres de b√≥rax","Barbante + palito"],
      passos: ["Dissolva b√≥rax na √°gua","Pendure barbante","Em 2h: cristais gigantes!"],
      video: "https://www.youtube.com/embed/4noaFzKoT1c",
      ingredientesIds: ["cristal"]
    },
    gelo: {
      nome: "Gelo Quente",
      ing: ["√Ålcool isoprop√≠lico","√Ågua gelada","Luvas"],
      passos: ["Misture 1:1 √°lcool + √°gua","Coloque m√£o com luva ‚Üí √°gua congela na hora!"],
      video: "https://www.youtube.com/embed/KUwkXNYF6dY",
      ingredientesIds: ["gelo"]
    }
  };

  const quizzes = {
    vulcao: {
      question: "Qual g√°s √© produzido na rea√ß√£o entre bicarbonato de s√≥dio e vinagre?",
      options: ["A) Oxig√™nio", "B) Di√≥xido de carbono", "C) Hidrog√™nio", "D) Nitrog√™nio"],
      correct: "B"
    },
    elefante: {
      question: "Qual subst√¢ncia atua como catalisador na decomposi√ß√£o da √°gua oxigenada?",
      options: ["A) Detergente", "B) Corante", "C) Fermento", "D) Bicarbonato"],
      correct: "C"
    },
    foguete: {
      question: "O que impulsiona o foguete para cima nesse experimento?",
      options: ["A) Calor", "B) Press√£o do g√°s", "C) For√ßa gravitacional", "D) Eletricidade"],
      correct: "B"
    },
    lava: {
      question: "Por que as bolhas coloridas sobem e descem na lava lamp caseira?",
      options: ["A) Devido √† diferen√ßa de densidade e rea√ß√£o qu√≠mica", "B) Por magnetismo", "C) Por evapora√ß√£o", "D) Por congelamento"],
      correct: "A"
    },
    repolho: {
      question: "O suco de repolho roxo √© usado como?",
      options: ["A) Corante permanente", "B) Indicador de pH", "C) Catalisador", "D) Ado√ßante"],
      correct: "B"
    },
    invisivel: {
      question: "Por que a tinta de lim√£o se torna vis√≠vel ao aquecer?",
      options: ["A) Evapora√ß√£o", "B) Rea√ß√£o com o ar", "C) Carboniza√ß√£o do a√ß√∫car", "D) Fluoresc√™ncia"],
      correct: "C"
    },
    cristal: {
      question: "Os cristais de b√≥rax se formam devido a?",
      options: ["A) Evapora√ß√£o r√°pida", "B) Solu√ß√£o supersaturada ao resfriar", "C) Rea√ß√£o √°cida", "D) Press√£o alta"],
      correct: "B"
    },
    gelo: {
      question: "O 'gelo quente' envolve a cristaliza√ß√£o exot√©rmica de uma solu√ß√£o supersaturada. Qual √© o processo principal?",
      options: ["A) Congelamento", "B) Cristaliza√ß√£o", "C) Sublima√ß√£o", "D) Destila√ß√£o"],
      correct: "B"
    }
  };

  const introScreen = document.getElementById('introScreen');
  const lab = document.querySelector('main.lab');
  const scoreBoard = document.getElementById('scoreBoard');
  const modal = document.getElementById('modal');
  const modalTitle = document.getElementById('titulo');
  const modalIngredients = document.getElementById('ing');
  const modalPassos = document.getElementById('passos');
  const modalVideo = modal.querySelector('.video');
  const closeBtn = modal.querySelector('.fechar');
  const feedback = document.getElementById('feedback');
  const quizModal = document.getElementById('quizModal');
  const quizTitle = document.getElementById('quizTitle');
  const quizQuestion = document.getElementById('quizQuestion');
  const optionsDiv = document.getElementById('options');
  const quizClose = document.getElementById('quizClose');

  let score = 0;
  let currentLevel = 1;
  let playerLevel = 1;
  let completedRecipes = new Set();

  // Inicia o jogo
  document.getElementById('startBtn').addEventListener('click', () => {
    introScreen.style.display = 'none';
    lab.style.display = 'block';
    updateScoreBoard();
    showLevel(currentLevel);
  });

  // Mostrar s√≥ as prateleiras do n√≠vel corrente
  function showLevel(level){
    const sections = lab.querySelectorAll('section');
    sections.forEach((sec, i) => {
      sec.style.display = (i === level-1) ? 'block' : 'none';
    });
    feedbackHide();
  }

  // Atualiza scoreboard
  function updateScoreBoard(){
    scoreBoard.textContent = `XP: ${score} | N√≠vel: ${playerLevel}`;
  }

  // Mostra feedback tempor√°rio
  function feedbackShow(msg){
    feedback.textContent = msg;
    feedback.classList.add('show');
    setTimeout(() => feedback.classList.remove('show'), 2500);
  }
  function feedbackHide(){
    feedback.classList.remove('show');
  }

  // Controla cliques nos frascos
  lab.querySelectorAll('.frasco').forEach(frasco => {
    frasco.addEventListener('click', () => {
      if(frasco.classList.contains('used')) return;
      const id = frasco.dataset.id;
      showQuiz(id);
    });
  });

  // Mostra quiz
  function showQuiz(key){
    const q = quizzes[key];
    quizTitle.textContent = `Descubra o Segredo de ${recipes[key].nome}`;
    quizQuestion.textContent = q.question;
    optionsDiv.innerHTML = '';
    q.options.forEach(opt => {
      const btn = document.createElement('button');
      btn.textContent = opt;
      btn.style.margin = '5px';
      btn.style.padding = '10px';
      btn.style.background = 'cyan';
      btn.style.color = 'black';
      btn.style.border = 'none';
      btn.style.borderRadius = '5px';
      btn.style.cursor = 'pointer';
      btn.style.width = '100%';
      btn.addEventListener('click', () => {
        const choice = opt.charAt(0);
        if(choice === q.correct){
          feedbackShow("Correto! Voc√™ descobriu o segredo cient√≠fico!");
          completeRecipe(key);
        } else {
          feedbackShow("Errado! Tente novamente.");
        }
        quizModal.classList.remove('show');
      });
      optionsDiv.appendChild(btn);
    });
    quizModal.classList.add('show');
  }

  // Completa receita
  function completeRecipe(key){
    completedRecipes.add(key);
    score += 10;
    updateScoreBoard();
    markUsed(key);
    showRecipeModal(key);

    const totalNivel = document.querySelectorAll(`#nivel${currentLevel} .frasco`).length;
    if(completedRecipes.size === totalNivel + levelsCompletedBefore()){
      feedbackShow(`Parab√©ns! Voc√™ completou o n√≠vel ${currentLevel}.`);
      playerLevel++;
      updateScoreBoard();
      if(currentLevel < 3){
        currentLevel++;
        setTimeout(() => {
          showLevel(currentLevel);
          feedbackShow(`Bem-vindo ao n√≠vel ${currentLevel}! Continue descobrindo!`);
        }, 1600);
      } else {
        setTimeout(() => {
          alert("Parab√©ns, Mestre Cientista! Voc√™ completou todos os n√≠veis e descobriu todos os segredos da ci√™ncia!");
          location.reload();
        }, 1600);
      }
    }
  }

  // Calcula total de receitas completadas em n√≠veis anteriores
  function levelsCompletedBefore(){
    let count = 0;
    if(currentLevel > 1){
      for(let lvl=1; lvl<currentLevel; lvl++){
        count += document.querySelectorAll(`#nivel${lvl} .frasco`).length;
      }
    }
    return count;
  }

  // Mostra modal com receita
  function showRecipeModal(key){
    const r = recipes[key];
    modalTitle.textContent = r.nome;
    modalIngredients.innerHTML = r.ing.map(ing => `<li>${ing}</li>`).join('');
    modalPassos.innerHTML = r.passos.map(p => `<li>${p}</li>`).join('');
    modalVideo.innerHTML = `<iframe src="${r.video}" title="${r.nome}" frameborder="0" allowfullscreen></iframe>`;
    modal.classList.add('show');
  }

  // Marca frascos usados (completos) com estilo
  function markUsed(key){
    const r = recipes[key];
    r.ingredientesIds.forEach(id=>{
      const frasco = document.querySelector(`.frasco[data-id="${id}"]`);
      frasco.classList.add('used');
    });
  }

  // Fecha modals
  closeBtn.addEventListener('click', () => {
    modal.classList.remove('show');
  });
  quizClose.addEventListener('click', () => {
    quizModal.classList.remove('show');
  });
</script>

</body>
</html>
